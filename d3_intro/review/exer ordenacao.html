<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico de barras</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
    <header>
        <h2>O script - Cria um gráfico de barras simples em uma página HTML</h2>
    </header>

    <div id="graph"></div> <!-- Div onde o gráfico será renderizado (Criado - inicialmente vazio.) -->

    <script type="text/javascript">
        let myValues = [1, 53, 64, 23, 21, 12, 98, 9, 2]; // Array de valores que serão usados para o gráfico

        function render(data) { // Função que renderiza o gráfico com os dados fornecidos - criar e atualizar o gráfico. 
                                            //Ela recebe um parâmetro data, mas, neste caso, não é usado dentro da função.

            // Criação dos elementos
            d3.select("#graph") // Seleciona o elemento com id "graph"
                .selectAll("div.h-bar") // Seleciona todos os <div> com a classe "h-bar" (inicialmente nenhum)
                .data(myValues.sort(d3.ascending)) // Junta os dados ao elemento, ordenando-os em ordem ascendente
                .enter() // Entra na seleção de dados que não têm correspondentes
                .append("div") // Adiciona um novo <div> para cada valor
                .attr("class", "h-bar") // Define a classe "h-bar" para cada novo <div>
                .append("span"); // Adiciona um <span> dentro de cada <div> para mostrar o valor

            // Atualização dos elementos
            d3.select("#graph") // Seleciona novamente o elemento "graph"
                .selectAll("div.h-bar") // Seleciona todos os <div> com a classe "h-bar"
                .data(myValues.sort(d3.ascending)) // Atualiza a junção com os dados (novamente em ordem ascendente)
                .style("width", function (d) { // Define a largura de cada <div> com base em seu valor
                    return (5 + d) + 'px'; // A largura é 5 pixels mais o valor
                })
                .select("span") // Seleciona o <span> dentro de cada <div>
                .text(function (d) { // Atualiza o texto dentro do <span>
                    return (d); // Define o texto como o valor correspondente
                });
        }

        render(myValues); // Chama a função render com myValues para gerar o gráfico
    </script>
</body>

</html>